openapi: 3.0.0
info:
  title: "Auth API Documentation"
  version: "1.0.0"
  description: |
    Complete authentication system including user registration, login, password reset, and token management.
    
    ## Authentication Flow
    1. Register or login to get tokens
    2. Use access token for protected endpoints (expires in 15m)
    3. Use refresh token to get new access token
    4. Logout to invalidate tokens

servers:
  - url: "http://localhost:3000/api/v1"
    description: "Local Development Server"
  - url: "https://your-api.com/api/v1"
    description: "Production Server"

tags:
  - name: "Authentication"
    description: "User authentication and authorization endpoints"

paths:
  /auth/register:
    post:
      tags: ["Authentication"]
      summary: "Register a new user"
      description: "Create a new user account with email and password"
      operationId: "registerUser"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: ["email", "password"]
              properties:
                email:
                  type: string
                  format: email
                  example: "user@example.com"
                password:
                  type: string
                  format: password
                  minLength: 8
                  example: "SecurePass123!"
                firstName:
                  type: string
                  example: "John"
                lastName:
                  type: string
                  example: "Doe"
      responses:
        "201":
          description: "User registered successfully"
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: object
                    properties:
                      user:
                        type: object
                        properties:
                          id:
                            type: string
                            format: uuid
                            example: "550e8400-e29b-41d4-a716-446655440000"
                          email:
                            type: string
                            example: "user@example.com"
                          firstName:
                            type: string
                            example: "John"
                          lastName:
                            type: string
                            example: "Doe"
                      accessToken:
                        type: string
                        example: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
                      refreshToken:
                        type: string
                        example: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
        "400":
          description: "Validation error"
        "409":
          description: "User already exists"

  /auth/login:
    post:
      tags: ["Authentication"]
      summary: "Login with email/password"
      description: "Authenticate user with email and password"
      operationId: "loginUser"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: ["email", "password"]
              properties:
                email:
                  type: string
                  format: email
                  example: "user@example.com"
                password:
                  type: string
                  format: password
                  example: "SecurePass123!"
      responses:
        "200":
          description: "Login successful"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AuthResponse"
        "401":
          description: "Invalid credentials"

  /auth/me:
    get:
      tags: ["Authentication"]
      summary: "Get current user info"
      description: "Get authenticated user's profile information"
      operationId: "getCurrentUser"
      security:
        - BearerAuth: []
      responses:
        "200":
          description: "User information retrieved"
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: object
                    properties:
                      id:
                        type: string
                        format: uuid
                      email:
                        type: string
                      firstName:
                        type: string
                      lastName:
                        type: string
        "401":
          description: "Not authenticated"

  /auth/refresh:
    post:
      tags: ["Authentication"]
      summary: "Refresh access token"
      description: "Get new access token using refresh token"
      operationId: "refreshToken"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: ["refreshToken"]
              properties:
                refreshToken:
                  type: string
                  example: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
      responses:
        "200":
          description: "Token refreshed successfully"

  /auth/logout:
    post:
      tags: ["Authentication"]
      summary: "Logout user"
      description: "Invalidate user session(s)"
      operationId: "logoutUser"
      security:
        - BearerAuth: []
      responses:
        "200":
          description: "Logged out successfully"

components:
  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT

  schemas:
    AuthResponse:
      type: object
      properties:
        success:
          type: boolean
          example: true
        data:
          type: object
          properties:
            user:
              type: object
              properties:
                id:
                  type: string
                  format: uuid
                email:
                  type: string
                firstName:
                  type: string
                lastName:
                  type: string
            accessToken:
              type: string
            refreshToken:
              type: string